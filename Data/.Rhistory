outliers=boxplot(proline$trans_proline~proline$Accession*proline$Treatment, plot=FALSE)$out
proline=proline[-which(proline$trans_proline %in% outliers),]
summarySE(proline,
measurevar = "trans_proline",
groupvars = c("Accession","Treatment"))
summarySE(proline,
measurevar = "Proline_Content",
groupvars = c("Accession","Treatment"))
model_proline=lm(trans_proline ~ Accession * Treatment, data=proline)
Anova(model_proline, type="II")
#Checking assumptions of model
hist(residuals(model_proline),col="darkgray") #appears approximately normal
shapiro.test(model_proline$residuals) #p>0.05 implying that the distribution of the data are not significantly different from normal distribution
plot(fitted(model_proline),residuals(model_proline)) #appears unbiased and homoscedastic
leveneTest(trans_proline ~ Accession*Treatment, data=proline) #p>0.05 implying that there is no evidence to suggest variance across groups is significant different, assuming homogeneity of variances
#Post-hoc comparison of least-square means w/ multcompView and lsmeans packages
lsmeans = lsmeans::lsmeans #uses ls means function from lsmeans package not from lmerTest package
leastsquare_proline = lsmeans(model_proline,pairwise ~ Accession*Treatment, adjust="tukey")
CLD(leastsquare_proline,
alpha=.05,
Letters=letters)
Anova(model_proline, type="II")
CLD(leastsquare_proline,
alpha=.05,
Letters=letters)
summarySE(proline,
measurevar = "Proline_Content",
groupvars = c("Accession","Treatment"))
#Post-hoc comparison of least-square means w/ multcompView and lsmeans packages
lsmeans = lsmeans::lsmeans #uses ls means function from lsmeans package not from lmerTest package
leastsquare_proline = lsmeans(model_proline,pairwise ~ Accession*Treatment, adjust="tukey")
CLD(leastsquare_proline,
alpha=.05,
Letters=letters)
Anova(model_proline, type="II")
#with Sb7 and Sb17
proline <- read.csv(file = "/Users/AshleyHenderson/Desktop/1. New Phytologist/Data/Data_Final/Data_Parts/Proline_Values.csv", header = TRUE, na.strings = "NA")
proline <-subset(proline, Treatment =="NaCl1" | Treatment == "Control")
proline <-na.omit(proline)
proline <- subset(proline, !Accession == "Sb6")
proline <- subset(proline, !Accession == "Tx1")
proline$trans_proline <-log(proline$Proline_Content)
outliers=boxplot(proline$trans_proline~proline$Accession*proline$Treatment, plot=FALSE)$out
proline=proline[-which(proline$trans_proline %in% outliers),]
summarySE(proline,
measurevar = "trans_proline",
groupvars = c("Accession","Treatment"))
summarySE(proline,
measurevar = "Proline_Content",
groupvars = c("Accession","Treatment"))
model_proline=lm(trans_proline ~ Accession * Treatment, data=proline)
Anova(model_proline, type="II")
#Checking assumptions of model
hist(residuals(model_proline),col="darkgray") #appears approximately normal
shapiro.test(model_proline$residuals) #p>0.05 implying that the distribution of the data are not significantly different from normal distribution
plot(fitted(model_proline),residuals(model_proline)) #appears unbiased and homoscedastic
leveneTest(trans_proline ~ Accession*Treatment, data=proline) #p>0.05 implying that there is no evidence to suggest variance across groups is significant different, assuming homogeneity of variances
#Post-hoc comparison of least-square means w/ multcompView and lsmeans packages
lsmeans = lsmeans::lsmeans #uses ls means function from lsmeans package not from lmerTest package
leastsquare_proline = lsmeans(model_proline,pairwise ~ Accession*Treatment, adjust="tukey")
CLD(leastsquare_proline,
alpha=.05,
Letters=letters)
summarySE(proline,
measurevar = "Proline_Content",
groupvars = c("Accession","Treatment"))
model_proline=lm(trans_proline ~ Accession * Treatment, data=proline)
Anova(model_proline, type="II")
#Checking assumptions of model
hist(residuals(model_proline),col="darkgray") #appears approximately normal
shapiro.test(model_proline$residuals) #p>0.05 implying that the distribution of the data are not significantly different from normal distribution
plot(fitted(model_proline),residuals(model_proline)) #appears unbiased and homoscedastic
leveneTest(trans_proline ~ Accession*Treatment, data=proline) #p>0.05 implying that there is no evidence to suggest variance across groups is significant different, assuming homogeneity of variances
#Post-hoc comparison of least-square means w/ multcompView and lsmeans packages
lsmeans = lsmeans::lsmeans #uses ls means function from lsmeans package not from lmerTest package
leastsquare_proline = lsmeans(model_proline,pairwise ~ Accession*Treatment, adjust="tukey")
CLD(leastsquare_proline,
alpha=.05,
Letters=letters)
library(magrittr)
library(plyr)
library(reshape2)
library(data.table)
library(tidyr)
library(dplyr)
library(gridExtra)
library(R.devices)
library(vegan)
library(lme4)
library(RLRsim)
library(labdsv)
library(ggplot2)
library(ggrepel)
library(plotly)
library(grid)
library(goeveg)
library(scales)
library(ggsci)
library(car)
library(multcompView)
library(lsmeans)
#install.packages("devtools")
#devtools::install_github("jaredhuling/jcolors")
library(jcolors)
library(ggpubr)
library(Rmisc)
library(agricolae)
#Figure S2 ####
Sb_AllAccessions_WholePlant <- read.csv(file = "/Users/AshleyHenderson/Desktop/1. New Phytologist/Data/Data_Final/Data_Parts/SorghumData_WholePlant_Raw.csv", header = TRUE, na.strings = "NA")
Sb_AllAccessions_WholePlant = subset(Sb_AllAccessions_WholePlant, Accession!="Sb-6")
Sb_AllAccessions_WholePlant = subset(Sb_AllAccessions_WholePlant, Accession!="Tx-1")
sb_means <- Sb_AllAccessions_WholePlant[,c(3:4,6:9,11,26,28,30:34,36)]
colnames(sb_means)
sb_means <-na.omit(sb_means)
sb_means <-subset(sb_means, subset=Treatment %in% c("Control","75mM"))
attach(sb_means)
sb.NMDS =metaMDS(sb_means[,c(3:6,8:14)],k=2)
NMDS.r <- data.frame(MDS1=sb.NMDS$points[,1],MDS2=sb.NMDS$points[,2]) #8
vec.r <-envfit(sb.NMDS$points, sb_means[c(3:6,8:14)],perm=1000) #9
vec.r
vec.r.df <- as.data.frame(vec.r$vectors$arrows*sqrt(vec.r$vectors$r*(1/20))) #10
vec.r.df$species <-rownames(vec.r.df) #11
fig2S <- ggplot(data=NMDS.r,aes(MDS1,MDS2)) + #12
geom_point(size=7.0,alpha=1.0,aes(shape=Treatment,color=Treatment)) +#13
scale_color_manual(values=c("darkorchid4","darkslategray3","olivedrab4"))+
theme(
plot.title = element_text(size=16, face="bold"),
axis.title.x = element_text(size=14),
axis.title.y = element_text(size=14),
axis.text=element_text(size = 10)
) +
theme(text=element_text(family="Times New Roman")) +
theme(legend.position = "bottom") +#18
theme_bw()+
ylab("NMDS1 Axis 2") + #19
xlab("NMDS Axis 1")+
#19
fig2S
fig2S <- ggplot(data=NMDS.r,aes(MDS1,MDS2)) + #12
geom_point(size=7.0,alpha=1.0,aes(shape=Treatment,color=Treatment)) +#13
scale_color_manual(values=c("darkorchid4","darkslategray3","olivedrab4"))+
theme(
plot.title = element_text(size=16, face="bold"),
axis.title.x = element_text(size=14),
axis.title.y = element_text(size=14),
axis.text=element_text(size = 10)
) +
theme(text=element_text(family="Times New Roman")) +
theme(legend.position = "bottom") +#18
theme_bw()+
ylab("NMDS1 Axis 2") + #19
xlab("NMDS Axis 1")+
#19
fig2S
fig2S <- ggplot(data=NMDS.r,aes(MDS1,MDS2)) + #12
geom_point(size=7.0,alpha=1.0,aes(shape=Treatment,color=Treatment)) +#13
scale_color_manual(values=c("darkorchid4","darkslategray3","olivedrab4"))+
theme(
plot.title = element_text(size=16, face="bold"),
axis.title.x = element_text(size=14),
axis.title.y = element_text(size=14),
axis.text=element_text(size = 10)
) +
theme(text=element_text(family="Times New Roman")) +
theme(legend.position = "bottom") +#18
theme_bw()+
ylab("NMDS1 Axis 2") + #19
xlab("NMDS Axis 1")
#19
fig2S
#ANOSIM Q1
BCdist.raw <-vegdist(sb_means[,c(6,8:14)],k=2,distance="bray") #20
treatment.anosim.r <-anosim(BCdist.raw,sb_means$Treatment,distance="bray",perm=999) #21
summary(treatment.anosim.r)
#Figure 3-STI ####
Sb_STI <- read.csv(file = "/Users/AshleyHenderson/Desktop/1. New Phytologist/Data/Data_Final/STI.csv", header = TRUE, na.strings = "NA")
Sb_STI = subset(Sb_STI, Accession!="Sb-6")
Sb_STI = subset(Sb_STI, Accession!="Tx-1")
Sb_STI_aagb<- subset(Sb_STI, STI == "AAGB")
Sb_STI_dagb<- subset(Sb_STI, STI == "DAGB")
Sb_STI_rb<- subset(Sb_STI, STI == "RB")
Sb_STI_aagb$Accession <-factor(Sb_STI_aagb$Accession, levels=Sb_STI_aagb$Accession[order(Sb_STI_aagb$Overall_Rank)])
Sb_STI_dagb$Accession <-factor(Sb_STI_dagb$Accession, levels=Sb_STI_dagb$Accession[order(Sb_STI_dagb$Overall_Rank)])
Sb_STI_rb$Accession <-factor(Sb_STI_rb$Accession, levels=Sb_STI_rb$Accession[order(Sb_STI_rb$Overall_Rank)])
fig3 <- ggplot(data=Sb_STI, aes(x=Accession, y=Rank, fill=STI)) + #12
geom_bar(stat="identity",width=0.5)+
scale_fill_manual(values=c("darkolivegreen4","burlywood4","darkred"))+
geom_text(aes(label=Rank),vjust=0.3,size=3)+
theme(
plot.title = element_text(size=16, face="bold"),
axis.title.x = element_text(size=14),
axis.title.y = element_text(size=14),
axis.text=element_text(size = 12)
) +
theme_bw()+
scale_x_discrete(limits=c("Sb-14","Sb-1","Sb-5","V-2","D-1","P-1","Sb-13","Sb-8","Sb-15","Sb-17","Sb-16","Sb-18","Sb-7","Sb-4","Sb-11","Sb-12","Sb-2","Sb-3","Sb-9","V-1","Sb-10")) +
theme(text=element_text(family="Times New Roman")) +theme(legend.position = "bottom") + #18
ylab("Overall") + #19
xlab("Accessions") #19
fig3
ggsave("fig3.eps",scale=1)
install.packages("VGAM")
citation(R)
citation()
#05/06/2025#####
library(dplyr)
library(readr)
library(edgeR)
library(tidyr)
library(ggplot2)
library(cowplot)
cat("\014")
library(edgeR)
citation("edgeR")
packageVersion("edgeR")
library(dplyr)
library(readr)
library(edgeR)
citation("edgeR")
packageVersion("edgeR")
library(tidyr)
library(ggplot2)
library(cowplot)
cat("\014")
rm(list=ls())
ls()
input_dir = "/Users/ashley/Desktop/GWAS/RNAseq/featureCounts on collection 189: Counts/"
files = list.files(path = input_dir, pattern = "\\.tabular$", full.names = TRUE)
library(dplyr)
library(readr)
library(edgeR)
citation("edgeR")
packageVersion("edgeR")
library(tidyr)
library(ggplot2)
library(cowplot)
cat("\014")
rm(list=ls())
ls()
input_dir = "/Users/ashley/Desktop/GWAS/RNAseq/featureCounts on collection 189: Counts/"
files = list.files(path = input_dir, pattern = "\\.tabular$", full.names = TRUE)
#list.files() lists all files in the folder:
#path = input_dir: searches within the correct folder.
#pattern = "\\.tabular$": filters to include only files ending in .tabular.
#\\. is the equivalent of (.); therefore \\.tabular literally means .tabular ; $ means end of string so having \\.tabular$ says "Look for files that end in .tabular"
#full.names = TRUE: returns the full file paths (needed for reading).
files
merged_data = NULL
#Initialize a Merged Object : I will build the merged table as we read each file. This just sets it up as NULL to start.
for (file in files) {
temp = read_tsv(file, col_types = cols()) #Loop through each file and read each .tabular file as a tibble; col_types = cols() means to guess the data types
colnames(temp)[1] = "Geneid" #Ensure the first column is named the exact same way everytime
if (is.null(merged_data)) { #For the first file, merged_data is null, so we just assign temp to "merged_data"
merged_data = temp
} else { #For subsequent files, we join the temp data file with the merged_data file by the Geneid
merged_data = full_join(merged_data, temp, by = "Geneid")
}
head(merged_data)
merged_data = as.data.frame(merged_data)
rownames(merged_data) = merged_data$Geneid
#merged_data$Geneid = NULL
head(merged_data)
#write_csv(merged_data, "/Users/ashley/Desktop/GWAS/RNAseq/merged_featureCounts.csv", )
data = merged_data
rm(list = setdiff(ls(), c("data")))
data$Geneid = NULL
head(data)
dge = DGEList(counts = data)
head(dge)
cpm_values = cpm(dge)  # Returns CPM values (not log-transformed)
#Rhizo Data File Prep####
cat("\014")
rm(list=ls())
ls()
setwd(dir = "/Users/ashley/Desktop/Hostetler_Pierce_et_al_2025/")
df = read.csv("NotPublishable/Rhizovision 2017 features.xlsx - Sheet1.csv", header = TRUE, na.strings = "NA")
head(df)
colnames(df)
head(df)
unique(df$Threshold)
unique(df$Notes)
df = df[,c(1:20,24:27)]
head(df)
df$Year = "2017"
colnames(df)[2] = "Genotype"
df$Genotype = trimws(df$Genotype)
df1 = read.csv("Data/Genotype_MasterSheet.csv", header = TRUE, na.strings = "NA")
head(df1)
data2 = merge(df, df1, by = "Genotype")
X = unique(data2$Genotype)
colnames(data)
colnames(data2)
data2 = data2[,c(1,25,2,3,4:6,10,13,22,23,24,7:9,15:18,11,12,14,20,19,21)]
colnames(data2)
for (i in 13:19) {
new_column_name = paste0(colnames(data2)[i], "_inch")
data2[[new_column_name]] = (data2[[i]] *(1/230))
}
colnames(data2)
for (i in 20:23) {
new_column_name = paste0(colnames(data2)[i], "_inch")
data2[[new_column_name]] = (data2[[i]] *(1/52900))
}
colnames(data2)
data2 = data2[,c(1:12,26:26,24,25)]
#Rhizo Data File Prep####
cat("\014")
rm(list=ls())
ls()
setwd(dir = "/Users/ashley/Desktop/Hostetler_Pierce_et_al_2025/")
df = read.csv("NotPublishable/Rhizovision 2017 features.xlsx - Sheet1.csv", header = TRUE, na.strings = "NA")
head(df)
colnames(df)
df = df[,c(1:20,24:27)]
head(df)
df$Year = "2017"
colnames(df)[2] = "Genotype"
df$Genotype = trimws(df$Genotype)
df1 = read.csv("Data/Genotype_MasterSheet.csv", header = TRUE, na.strings = "NA")
head(df1)
data2 = merge(df, df1, by = "Genotype")
X = unique(data2$Genotype)
colnames(data2)
data2 = data2[,c(1,25,2,3,4:6,10,13,22,23,24,7:9,15:18,11,12,14,20,19,21)]
colnames(data2)
for (i in 13:19) {
new_column_name = paste0(colnames(data2)[i], "_inch")
data2[[new_column_name]] = (data2[[i]] *(1/230))
}
colnames(data2)
for (i in 20:23) {
new_column_name = paste0(colnames(data2)[i], "_inch")
data2[[new_column_name]] = (data2[[i]] *(1/52900))
}
colnames(data2)
data2 = data2[,c(1:12,26:36,24,25)]
colnames(data2)
#Rhizo Data File Prep####
cat("\014")
rm(list=ls())
ls()
setwd(dir = "/Users/ashley/Desktop/Hostetler_Pierce_et_al_2025/")
df = read.csv("NotPublishable/Rhizovision 2017 features.xlsx - Sheet1.csv", header = TRUE, na.strings = "NA")
head(df)
colnames(df)
df = df[,c(1:20,24:27)]
head(df)
df$Year = "2017"
colnames(df)[2] = "Genotype"
df$Genotype = trimws(df$Genotype)
df1 = read.csv("Data/Genotype_MasterSheet.csv", header = TRUE, na.strings = "NA")
head(df1)
data2 = merge(df, df1, by = "Genotype")
X = unique(data2$Genotype)
colnames(data2)
data2 = data2[,c(1,25,2,3,4:6,10,13,22,23,24,7:9,15:18,11,12,14,20,19,21)]
colnames(data2)
for (i in 13:19) {
new_column_name = paste0(colnames(data2)[i], "_inch")
data2[[new_column_name]] = (data2[[i]] *(1/230))
}
colnames(data2)
for (i in 20:23) {
new_column_name = paste0(colnames(data2)[i], "_inch")
data2[[new_column_name]] = (data2[[i]] *(1/52900))
}
230^3
for (i in 24) {
new_column_name = paste0(colnames(data2)[i], "_inch")
data2[[new_column_name]] = (data2[[i]] *(1/12167000))
}
colnames(data2)
data2 = data2[,c(1:12,26:36,37,25)]
colnames(data2)
colnames(data2)[8] = "Width:Depth"
colnames(data2)[9] = "Solidity"
colnames(data2)[10] = "ShallowAngleFrequency"
colnames(data2)[11] = "MediumAngleFrequency"
colnames(data2)[12] = "SteepAngleFrequency"
colnames(data2)[13] = "TotalRL_in"
colnames(data2)[14] = "Depth_in"
colnames(data2)[15] = "MaxWidth_in"
colnames(data2)[16] = "AverageDiameter_in"
colnames(data2)[17] = "MedianDiameter_in"
colnames(data2)[18] = "MaxDiameter_in"
colnames(data2)[19] = "Perimeter_in"
colnames(data2)[20] = "NetworkArea_in2"
colnames(data2)[21] = "ConvexArea_in2"
colnames(data2)[22] = "LowerRootArea_in2"
colnames(data2)[23] = "SurfaceArea_in2"
colnames(data2)[24] = "Volume_in3"
colnames(data2)
for (i in 13:19) {
new_column_name = paste0(colnames(data2)[i], "_cm")
data2[[new_column_name]] = (data2[[i]] *2.54)
}
colnames(data2)
for (i in 20:23) {
new_column_name = paste0(colnames(data2)[i], "_cm2")
data2[[new_column_name]] = (data2[[i]] *(2.54^2))
}
colnames(data2)
for (i in 24) {
new_column_name = paste0(colnames(data2)[i], "_cm3")
data2[[new_column_name]] = (data2[[i]] *(2.54^3))
}
colnames(data2)
data2 = data2[,c(1:12,26:37,25)]
colnames(data2)
colnames(data2) = gsub("_in3_cm3", "_cm3", colnames(data2))
colnames(data2) = gsub("_in2_cm2", "_cm2", colnames(data2))
colnames(data2) = gsub("_in_cm", "_cm", colnames(data2))
colnames(data2)
unique(data2$File.Name)
data2=data2 %>% separate(File.Name, c("Plot","Plant","Whorl","TestingDate","FileType"), sep = '[-_.]')
library(ggplot2)
citation("ggplot2")
packageVersion("ggplot2")
library(dplyr)
citation("dplyr")
packageVersion("dplyr")
library(tidyr)
citation("tidyr")
packageVersion("tidyr")
data2=data2 %>% separate(File.Name, c("Plot","Plant","Whorl","TestingDate","FileType"), sep = '[-_.]')
head(data2)
unique(data2$Whorl)
data3 = subset(data2, Whorl == 0)
View(data3)
X = unique(data3$Genotype)
unique(data2$Region.of.Interest)
head(data)
head(data3)
colnames(data3)
data3 = data3[,c(1,2,3,4,6,9:29)]
colnames(data3)
write.csv(data3, file = "Data/RhizovisionData2017_55&Friends.csv", row.names = FALSE)
getwd()
#Script associated with Hostetler and Pierce et al., 2025####
library(ggplot2)
citation("ggplot2")
packageVersion("ggplot2")
library(dplyr)
citation("dplyr")
packageVersion("dplyr")
library(agricolae) #HSD Test
citation("agricolae")
packageVersion("agricolae")
library(rcompanion) #transformTukey Test
citation("rcompanion")
packageVersion("rcompanion")
library(ggtext) #coloring x axis
citation("ggtext")
packageVersion("ggtext")
library(lme4) #H2
citation("lme4")
packageVersion("lme4")
library(PerformanceAnalytics) #Correlations Matrix
citation("PerformanceAnalytics")
packageVersion("PerformanceAnalytics")
library(corrplot) #Correlations
citation("corrplot")
packageVersion("corrplot")
library(factoextra) #get_pca_var
citation("factoextra")
packageVersion("factoextra")
library(ggfortify) #autplot
citation("ggfortify")
packageVersion("ggfortify")
library(cowplot) #autplot
citation("cowplot")
packageVersion("cowplot")
library(tidyr) #pivotwider
citation("tidyr")
packageVersion("tidyr")
library(stringr)
citation("stringr")
packageVersion("stringr")
library("janitor")
citation("janitor")
packageVersion("janitor")
library(tidymodels)
citation("tidymodels")
packageVersion("tidymodels")
library(ranger)
citation("ranger")
packageVersion("ranger")
library(kknn)
citation("kknn")
packageVersion("kknn")
library(randomForest)
citation("randomForest")
packageVersion("randomForest")
cat("\014")
rm(list=ls())
ls()
setwd(dir = "/Users/ashley/Desktop/Hostetler_Pierce_et_al_2025/Data/")
getwd()
#The root system architecture varies among maize inbreds####
par(mfrow=c(1,1))
data = read.csv("RhizovisionData2017_55&Friends.csv", header = TRUE, na.strings = "NA")
head(data)
summary_table = data %>%
group_by(Genotype) %>%
summarise(
n_Plots = n_distinct(Plot),
Plants_per_Plot = paste(unique(
sapply(split(Plant, Plot), function(x) length(unique(x)))
), collapse = ", ")
)
summary_table
View(summary_table)
